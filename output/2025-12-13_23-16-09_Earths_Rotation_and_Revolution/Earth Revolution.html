<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Earth's Orbit & Tilt - Interactive Simulation</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            line-height: 1.6;
            color: #333;
            background: #f9f9f9;
        }
        #app { 
            max-width: 600px; 
            margin: 0 auto; 
            padding: 16px;
            background: white;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            gap: 16px;
        }
        header {
            padding: 16px 0;
            text-align: center;
            border-bottom: 2px solid #e0e0e0;
        }
        h1 { font-size: 24px; margin-bottom: 8px; color: #2C3E50; }
        .subtitle { font-size: 14px; color: #666; }
        
        #visual-area {
            position: relative;
            height: 50vh; /* Responsive height */
            min-height: 300px; /* Minimum height for small screens */
            background: #1A2C3A; /* Deep space background */
            border-radius: 8px;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden; /* Ensures nothing overflows the rounded corners */
            box-shadow: inset 0 0 10px rgba(0,0,0,0.3);
            flex-grow: 1; /* Allow visual area to grow if space permits */
        }
        
        #solar-system-svg {
            width: 90%; /* Responsive width */
            max-width: 600px; /* Max width constraint */
            height: auto;
            display: block; /* Remove extra space below SVG */
        }

        #controls {
            padding: 16px;
            background: #fafafa;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .control-group {
            margin-bottom: 16px;
        }
        
        .control-label {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
            font-weight: 500;
            font-size: 16px; /* Minimum font size */
        }
        
        input[type="range"] {
            width: 100%;
            height: 48px; /* Touch target height */
            -webkit-appearance: none;
            appearance: none; /* Remove default appearance */
            background: #e0e0e0;
            border-radius: 5px;
            outline: none;
            transition: opacity .2s;
        }

        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #2196F3;
            cursor: pointer;
            box-shadow: 0 1px 3px rgba(0,0,0,0.2);
            transition: background 0.2s ease;
        }

        input[type="range"]::-moz-range-thumb {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #2196F3;
            cursor: pointer;
            box-shadow: 0 1px 3px rgba(0,0,0,0.2);
            transition: background 0.2s ease;
        }

        input[type="range"]:hover::-webkit-slider-thumb {
            background: #1976D2;
        }
        input[type="range"]:hover::-moz-range-thumb {
            background: #1976D2;
        }
        
        .button-group {
            display: flex;
            gap: 8px;
            margin-top: 16px;
        }

        button {
            flex: 1;
            min-height: 48px; /* Touch target height */
            padding: 12px;
            font-size: 16px;
            background: #4CAF50;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            transition: background 0.3s ease, transform 0.1s ease;
        }
        
        button:active {
            transform: scale(0.98);
        }

        button.secondary {
            background: #f44336; /* Red for reset */
        }
        button.secondary:hover {
            background: #d32f2f;
        }

        button:hover {
            background: #43A047;
        }
        
        #info {
            padding: 16px;
            background: #e3f2fd;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            font-size: 14px; /* Caption font size */
        }

        #info p {
            margin-bottom: 8px;
        }
        #info p:last-child {
            margin-bottom: 0;
        }
        .info-label {
            font-weight: 500;
            color: #2C3E50;
        }
    </style>
</head>
<body>
    <div id="app">
        <header>
            <h1>Earth's Seasons & Axial Tilt</h1>
            <p class="subtitle">An interactive simulation of Earth's revolution and tilt.</p>
        </header>
        
        <div id="visual-area">
            <svg id="solar-system-svg" viewBox="0 0 1000 1000">
                <defs>
                    <!-- Sun glow filter -->
                    <filter id="sunGlow" x="-50%" y="-50%" width="200%" height="200%">
                        <feGaussianBlur in="SourceGraphic" stdDeviation="15" result="blur"></feGaussianBlur>
                        <feMerge>
                            <feMergeNode in="blur"></feMergeNode>
                            <feMergeNode in="SourceGraphic"></feMergeNode>
                        </feMerge>
                    </filter>

                    <!-- Earth texture pattern: simplified blue ocean base, green land patches -->
                    <pattern id="earthPattern" x="0" y="0" width="1" height="1" patternContentUnits="objectBoundingBox">
                        <image href="data:image/svg+xml;base64,PHN2ZyB2aWV3Qm94PSIwIDAgNzAgNzAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CgogIDxyZWN0IHdpZHRoPSI3MCIgaGVpZ2h0PSI3MCIgZmlsbD0iIzIxOTZGMCIgLz4KCiAgPHBhdGggZD0iTTcuMjUgNDUuOTgxQzguMjggNDYuOTUxIDkuNzE5IDQ3LjU5MyAxMS4yNSAyMi41QzE2Ljc3OSA0LjQwNSAyNi43NTUgLTAuNTU5IDMwLjI0MyAwLjAxQzMyLjU4MSAwLjMzMiAzMy44NjMgMi4wNzQgMzMuOTkzIDQuMTY4QzM0LjEzMiA2Ljc5MiAzMi43NjMgOS40NjMgMzAuOTY3IDEwLjE0MkMyNS43MDUgMTEuMjY0IDE1LjE0OSAxMC44MzcgMTUuMjYxIDE4LjI1QzE1LjM1NiAyNS43OTcgMzMuOTMyIDI4LjQzNyAzNy4yNTcgMjguNDg2QzQxLjI1NiAyOC41NzIgNDQuNDkyIDI4LjI4MiA0NS43NTYgMjUuOTQyQzQ4LjA5MiAyMS42NjIgNDMuMzg0IDE0LjkxOSA0MS4wNDUgMTEuMDkxQzQwLjI3NSAxMC40MjIgMzcuMTQ0IDkuODc2IDM3LjI1IDYuNTQ2QzM3LjQ0NyAxLjQ4NCA0MS4yODkgMC4zMjcgNDQuMzg3IDAuMDRDNTAuNTY3IC0wLjQ4MyA2MS4wNTQgMS44OTUgNjQuNTYyIDQuMjk4QzY5LjIwOSA3LjU1IDcwLjAwMiAxNy40ODYgNjguNDExIDE4LjI1QzY2Ljc2IDI1LjY1OSA0OC42NzkgMzIuMDcyIDM4LjQ3MSAzMi4wODJDMTguODUzIDMyLjA5MiAzLjQzMyAyMi41NjEgNy4yNSA0NS45ODFaTTQ4LjQxNCA1MC45OTNDNDkuODggNDkuNjQ1IDUwLjcwMiAzNy44MDcgNTAuOTg3IDQ3LjUzNkM1MS41NjcgNDYuNjk5IDUxLjk5IDQ2LjI2OSA1Mi4zOSA0NS44MzJDNTMuNTU1IDQ0LjU4IDUzLjQ0OSAzMy4xNjggNTMuMjA4IDQxLjY0NUM1Mi44MiAzOC45NDggNTEuNjU1IDM2LjY5MiA0OS44MTcgMzUuMDgyQzQ2LjY5OCAzMi4yNDcgNDMuNTU5IDMwLjg1NiAzNi44NjQgMjkuNzk5QzMwLjY4MiAyOC44MzcgMjYuMTEyIDI3LjUyNCAyNS40NzggMjIuMjQ4QzI0LjM1NSA2LjgzNCAzNy44MjEgMS43MjQgNDIuMjgyIDAuNzNDNDYuNzQzIC0wLjMwNSA1MC44MyAwLjc0IDU2LjczNyAxLjI0NEM2MS4yNDIgMS42OTMgNjYuOTEgNC42MDcgNjcuNTk2IDUuMTNDNjguODY1IDUuNjkyIDY5LjgwMSA5LjEzOSA2OS44MDYgMTMuMzAzQzY5LjgwNiAxOC4xODQgNjguNzQ3IDIyLjUxNiA2Ny4zOTggMjYuMTg2QzY0LjAzMyAzNy45NzYgNjAuNjkyIDQ1Ljc2MiA1Ny4wMTEgNTAuOTUzQzUzLjM0NyA1Ni4xMzcgNDguNDg1IDU4LjMzMiA0Mi40NCA1OS41MzlDMzYuMzkgNjAuNzQ3IDI4LjA0MiA2MS4xNjUgMjcuMDYzIDU4LjY3N0MyNS4yNjMgNTQuMTA5IDI2LjA4NCA0OS41NjggMzAuNjQ4IDQ3LjIxNEMzNi4xNTMgNDMuMDk3IDQ2Ljg5MyA0Mi4zMiA0OC40MTQgNTAuOTkzWiIgb3BhY2l0eT0iMC41NSIgZmlsbD0iIzRDQUY1MCIgLz4KPC9zdmc+" x="0" y="0" width="1" height="1"/>
                    </pattern>
                    
                    <!-- Clip path for the night side. This defines the right half of a circle (for radius 40, centered at 0,0). -->
                    <clipPath id="halfCircleClip">
                        <rect x="0" y="-40" width="40" height="80"/>
                    </clipPath>
                </defs>

                <!-- Sun -->
                <circle cx="500" cy="500" r="80" fill="#FFD700" filter="url(#sunGlow)"/>

                <!-- Orbit path -->
                <ellipse cx="500" cy="500" rx="350" ry="250" stroke="#CCCCCC" stroke-width="2" fill="none" opacity="0.4"/>

                <!-- Earth Group: All Earth-related elements, translated for orbit -->
                <g id="earth-orbit-group" transform="translate(500 500)">
                    <!-- Earth container: This group is translated for orbital position relative to the orbit center -->
                    <g id="earth-container" transform="translate(350 0)"> 
                        <!-- Earth sphere (day side / base texture) -->
                        <circle id="earth-sphere" r="40" fill="url(#earthPattern)"/>

                        <!-- Earth's night side: full dark circle, clipped to a half, rotated for day/night and tilt visual -->
                        <g id="earth-rotation-group">
                            <circle r="40" fill="#2C3E50" opacity="0.8" clip-path="url(#halfCircleClip)"/>
                        </g>

                        <!-- Earth's Tilted Axis: centered on Earth, rotated for tilt and to keep direction fixed in space -->
                        <line id="earth-axis" x1="0" y1="-50" x2="0" y2="50" stroke="#FFFFFF" stroke-dasharray="4 4" stroke-width="2" opacity="0.7"/>
                    </g>
                </g>
            </svg>
        </div>
        
        <div id="controls">
            <div class="control-group">
                <label for="axialTiltSlider" class="control-label">Axial Tilt: <span id="axialTiltValue">23.5</span>°</label>
                <input type="range" id="axialTiltSlider" min="0" max="45" value="23.5" step="0.1">
            </div>
            
            <div class="control-group">
                <label for="revolutionSpeedSlider" class="control-label">Orbit Speed: <span id="revolutionSpeedValue">0.3</span>x</label>
                <input type="range" id="revolutionSpeedSlider" min="0" max="2" value="0.3" step="0.05">
            </div>
            
            <div class="control-group">
                <label for="rotationSpeedSlider" class="control-label">Spin Speed: <span id="rotationSpeedValue">2</span>x</label>
                <input type="range" id="rotationSpeedSlider" min="0" max="10" value="2" step="0.1">
            </div>

            <div class="button-group">
                <button id="playPauseButton">Pause</button>
                <button id="resetButton" class="secondary">Reset</button>
            </div>
        </div>
        
        <div id="info">
            <p><span class="info-label">Current Orbital Angle:</span> <span id="orbitalAngleInfo">0</span>°</p>
            <p><span class="info-label">Current Earth Spin Angle:</span> <span id="earthSpinAngleInfo">0</span>°</p>
            <p><span class="info-label">Season (NH):</span> <span id="currentSeasonInfo">Northern Winter / Southern Summer</span></p>
            <p class="subtitle">Visual metaphor: Imagine a spinning top (Earth) walking in a circle around a bright lamp (Sun). The top's tilt (Earth's axis) determines which part gets more light as it walks around.</p>
        </div>
    </div>
    
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // --- DOM Element References --- 
            const solarSystemSvg = document.getElementById('solar-system-svg');
            const sunSvg = solarSystemSvg.querySelector('circle[r="80"]'); // Sun
            const orbitPathSvg = solarSystemSvg.querySelector('ellipse'); // Orbit path
            const earthOrbitGroup = document.getElementById('earth-orbit-group'); // Group for orbital motion
            const earthContainer = document.getElementById('earth-container'); // Group for Earth and its axis
            const earthSphere = document.getElementById('earth-sphere'); // Base Earth circle
            const earthRotationGroup = document.getElementById('earth-rotation-group'); // Group for day/night rotation
            const earthAxis = document.getElementById('earth-axis'); // Earth's axis line

            const axialTiltSlider = document.getElementById('axialTiltSlider');
            const revolutionSpeedSlider = document.getElementById('revolutionSpeedSlider');
            const rotationSpeedSlider = document.getElementById('rotationSpeedSlider');
            const playPauseButton = document.getElementById('playPauseButton');
            const resetButton = document.getElementById('resetButton');

            const axialTiltValueSpan = document.getElementById('axialTiltValue');
            const revolutionSpeedValueSpan = document.getElementById('revolutionSpeedValue');
            const rotationSpeedValueSpan = document.getElementById('rotationSpeedValue');
            const orbitalAngleInfo = document.getElementById('orbitalAngleInfo');
            const earthSpinAngleInfo = document.getElementById('earthSpinAngleInfo');
            const currentSeasonInfo = document.getElementById('currentSeasonInfo');

            // --- State Variables ---
            let axialTiltDeg = parseFloat(axialTiltSlider.value);
            let revolutionSpeed = parseFloat(revolutionSpeedSlider.value);
            let rotationSpeed = parseFloat(rotationSpeedSlider.value);
            let orbitAngleDeg = 0; // Earth's position around Sun (0-359 degrees)
            let earthRotationAngleDeg = 0; // Earth's rotation on its own axis (0-359 degrees)
            let isPaused = false;
            let animationFrameId = null;

            // --- Constants for SVG calculations (based on viewBox 0 0 1000 1000) ---
            const SVG_CENTER_X = 500;
            const SVG_CENTER_Y = 500;
            const ORBIT_RX = 350; // Horizontal radius of Earth's orbit
            const ORBIT_RY = 250; // Vertical radius of Earth's orbit
            const EARTH_RADIUS = 40; // Defined in SVG for consistency with clipPath

            // --- Update Functions ---
            const updateVisuals = () => {
                try {
                    // 1. Earth's Orbital Position
                    const orbitRad = orbitAngleDeg * Math.PI / 180;
                    const earthX = ORBIT_RX * Math.cos(orbitRad);
                    const earthY = ORBIT_RY * Math.sin(orbitRad);
                    earthContainer.setAttribute('transform', `translate(${earthX} ${earthY})`);

                    // 2. Earth's Daily Rotation and Day/Night Terminator
                    // Angle from Earth to Sun. Used to orient the day/night split.
                    // If Earth is at (earthX, earthY), Sun is at (0,0) (relative to earthOrbitGroup center).
                    // So vector from Earth to Sun is (-earthX, -earthY).
                    const angleToSunFromEarth = Math.atan2(-earthY, -earthX) * 180 / Math.PI;
                    
                    // The `halfCircleClip` makes the visible part to the RIGHT (x > 0) of the center.
                    // We need to rotate `earthRotationGroup` so its `right` half becomes the night side (facing away from the sun).
                    // If `angleToSunFromEarth` is 0 (Sun is directly to the right of Earth, i.e., at 3 o'clock), night side should be on the left.
                    // This means the `right` half (clipped) needs to be rotated by 180 degrees to appear on the left.
                    // If `angleToSunFromEarth` is 180 (Sun is directly to the left of Earth, i.e., at 9 o'clock), night side should be on the right.
                    // This means the `right` half (clipped) needs to be rotated by 0 degrees to appear on the right.
                    // So, the formula is `(angleToSunFromEarth - 180) + earthRotationAngleDeg`. This correctly aligns the clipped half.
                    let nightSideRotation = (angleToSunFromEarth - 180) + earthRotationAngleDeg;
                    earthRotationGroup.setAttribute('transform', `rotate(${nightSideRotation})`);

                    // 3. Earth's Tilted Axis (fixed in space)
                    // The axis is inside `earth-container`. Its rotation is relative to `earth-container`'s origin (Earth's center).
                    // To make it appear fixed in space (always pointing in the same global direction),
                    // we apply the axial tilt and then counter-rotate it by the orbital angle.
                    // This compensates for the `earth-container`'s implicit rotation around the Sun.
                    const axisRotationAngle = axialTiltDeg - orbitAngleDeg; // Simulates fixed-in-space orientation
                    earthAxis.setAttribute('transform', `rotate(${axisRotationAngle})`);

                } catch (error) {
                    console.error("Error updating visuals:", error);
                }
            };

            const updateInfo = () => {
                try {
                    axialTiltValueSpan.textContent = axialTiltDeg.toFixed(1);
                    revolutionSpeedValueSpan.textContent = revolutionSpeed.toFixed(1);
                    rotationSpeedValueSpan.textContent = rotationSpeed.toFixed(1);
                    orbitalAngleInfo.textContent = orbitAngleDeg.toFixed(1);
                    earthSpinAngleInfo.textContent = earthRotationAngleDeg.toFixed(1);

                    // Determine season for Northern Hemisphere based on orbitAngleDeg and axialTiltDeg
                    let season = "Equinox";
                    if (axialTiltDeg > 1) { // Only show distinct seasons if there's a significant tilt
                        // Orbital angles relative to Earth's position (0deg is Earth right of Sun, 90deg top, etc.)
                        // At 0deg (Earth right of Sun): Axis (initially up-left at 23.5deg) means NH tilted away from Sun.
                        // So, 0deg ~ Northern Winter.
                        if (orbitAngleDeg >= 315 || orbitAngleDeg < 45) { 
                            season = "Northern Winter / Southern Summer";
                        } else if (orbitAngleDeg >= 45 && orbitAngleDeg < 135) { 
                            season = "Northern Spring Equinox"; 
                        } else if (orbitAngleDeg >= 135 && orbitAngleDeg < 225) { 
                            season = "Northern Summer / Southern Winter";
                        } else if (orbitAngleDeg >= 225 && orbitAngleDeg < 315) { 
                            season = "Northern Autumn Equinox"; 
                        }
                    } else {
                        season = "No significant tilt - Equinox all year";
                    }
                    currentSeasonInfo.textContent = season;

                } catch (error) {
                    console.error("Error updating info:", error);
                }
            };

            // --- Animation Loop ---
            const animate = () => {
                if (!isPaused) {
                    orbitAngleDeg = (orbitAngleDeg + revolutionSpeed) % 360;
                    earthRotationAngleDeg = (earthRotationAngleDeg + rotationSpeed) % 360;
                }
                updateVisuals();
                updateInfo();
                animationFrameId = requestAnimationFrame(animate);
            };

            // --- Control Handlers ---
            const togglePlayPause = () => {
                isPaused = !isPaused;
                playPauseButton.textContent = isPaused ? "Play" : "Pause";
                if (!isPaused && !animationFrameId) {
                    // If paused and animation frame was cancelled, restart it
                    animate();
                } else if (isPaused && animationFrameId) {
                    // If playing and now paused, cancel animation frame
                    cancelAnimationFrame(animationFrameId);
                    animationFrameId = null;
                }
            };

            const resetSimulation = () => {
                axialTiltDeg = 23.5;
                revolutionSpeed = 0.3;
                rotationSpeed = 2;
                orbitAngleDeg = 0; // Reset Earth to initial position (right of Sun)
                earthRotationAngleDeg = 0; // Reset Earth's daily spin
                isPaused = false;

                // Update sliders
                axialTiltSlider.value = axialTiltDeg;
                revolutionSpeedSlider.value = revolutionSpeed;
                rotationSpeedSlider.value = rotationSpeed;

                // Update button text
                playPauseButton.textContent = "Pause";

                // Ensure animation is running
                if (animationFrameId) cancelAnimationFrame(animationFrameId); // Stop existing if any
                animationFrameId = null; // Clear ID
                animate(); // Start new animation cycle
            };

            // --- Event Listeners ---
            axialTiltSlider.addEventListener('input', (e) => {
                axialTiltDeg = parseFloat(e.target.value);
                updateVisuals(); // Update visuals immediately for tilt changes
                updateInfo();    // Update info immediately
            });

            revolutionSpeedSlider.addEventListener('input', (e) => {
                revolutionSpeed = parseFloat(e.target.value);
                updateInfo(); // Only info display needs immediate update
            });

            rotationSpeedSlider.addEventListener('input', (e) => {
                rotationSpeed = parseFloat(e.target.value);
                updateInfo(); // Only info display needs immediate update
            });

            playPauseButton.addEventListener('click', togglePlayPause);
            resetButton.addEventListener('click', resetSimulation);

            // --- Initial Setup and Start Animation ---
            updateVisuals(); // Set initial positions and states
            updateInfo();   // Set initial info display
            animate();      // Start the animation loop
        });
    </script>
</body>
</html>