{
  "fixed": true,
  "index.html": "<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Flow of Heat - Interactive Simulation</title>\n    <style>\n        * { margin: 0; padding: 0; box-sizing: border-box; }\n        body {\n            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;\n            line-height: 1.6;\n            color: #333;\n            background: #f9f9f9;\n        }\n        #app {\n            max-width: 600px;\n            margin: 0 auto;\n            padding: 16px;\n            background: white;\n            min-height: 100vh;\n            box-shadow: 0 0 15px rgba(0,0,0,0.05);\n        }\n        header {\n            padding: 16px 0;\n            text-align: center;\n            border-bottom: 2px solid #e0e0e0;\n        }\n        h1 { font-size: 24px; margin-bottom: 8px; color: #2c3e50; }\n        .subtitle { font-size: 14px; color: #7f8c8d; }\n        \n        #visual-area {\n            position: relative;\n            height: 50vh;\n            min-height: 300px; /* Minimum height for visual clarity */\n            background: #f5f5f5;\n            border-radius: 8px;\n            margin: 16px 0;\n            display: flex; /* Use flexbox for centering */\n            justify-content: center;\n            align-items: center;\n            overflow: hidden;\n            box-shadow: inset 0 0 5px rgba(0,0,0,0.1);\n        }\n        \n        #controls {\n            padding: 16px;\n            background: #fafafa;\n            border-radius: 8px;\n            margin: 16px 0;\n            box-shadow: 0 2px 5px rgba(0,0,0,0.05);\n        }\n        \n        .control-group {\n            margin-bottom: 16px;\n        }\n        \n        .control-label {\n            display: flex;\n            justify-content: space-between;\n            align-items: center;\n            margin-bottom: 8px;\n            font-weight: 600;\n            font-size: 16px;\n            color: #34495e;\n        }\n        \n        input[type=\"range\"] {\n            width: 100%;\n            height: 44px; /* Ensure touch target */\n            -webkit-appearance: none;\n            background: #ecf0f1;\n            border-radius: 5px;\n            outline: none;\n            transition: opacity .2s;\n        }\n        \n        input[type=\"range\"]::-webkit-slider-thumb {\n            -webkit-appearance: none;\n            appearance: none;\n            width: 25px;\n            height: 25px;\n            border-radius: 50%;\n            background: #3498db;\n            cursor: pointer;\n            border: 2px solid #fff;\n            box-shadow: 0 0 5px rgba(0,0,0,0.2);\n        }\n        \n        input[type=\"range\"]::-moz-range-thumb {\n            width: 25px;\n            height: 25px;\n            border-radius: 50%;\n            background: #3498db;\n            cursor: pointer;\n            border: 2px solid #fff;\n            box-shadow: 0 0 5px rgba(0,0,0,0.2);\n        }\n\n        button {\n            width: 100%;\n            min-height: 48px; /* Ensure touch target */\n            padding: 12px;\n            font-size: 17px;\n            background: #28a745; /* Green for start */\n            color: white;\n            border: none;\n            border-radius: 6px;\n            cursor: pointer;\n            margin-top: 8px;\n            transition: background 0.3s ease, transform 0.2s ease;\n            font-weight: 600;\n        }\n        \n        button:hover:not(:disabled) {\n            background: #218838;\n        }\n\n        button:active:not(:disabled) {\n            transform: scale(0.98);\n        }\n\n        button:disabled {\n            background: #cccccc;\n            cursor: not-allowed;\n            opacity: 0.7;\n        }\n        \n        #info {\n            padding: 16px;\n            background: #e3f2fd;\n            border-radius: 8px;\n            margin: 16px 0;\n            font-size: 16px;\n            color: #2196f3;\n            text-align: center;\n            box-shadow: 0 2px 5px rgba(0,0,0,0.05);\n            font-weight: 500;\n        }\n\n        .status-message {\n            margin-top: 10px;\n            font-weight: bold;\n            color: #d32f2f; /* Red for status message */\n        }\n\n        /* SVG specific styles */\n        #simulation_svg {\n            width: 90%; /* Responsive width */\n            max-width: 400px;\n            height: auto;\n            display: block; /* Remove extra space below SVG */\n        }\n\n        .object-container {\n            transition: fill 0.5s ease-out; /* Smooth color transition for objects */\n            stroke: #333;\n            stroke-width: 2;\n        }\n\n        .object-label, .temperature-label {\n            fill: #333;\n        }\n        .temperature-label {\n            font-weight: bold;\n        }\n        \n        #flow_arrow {\n            transition: opacity 0.3s ease;\n            stroke: #ff9800; /* Orange arrow */\n            stroke-width: 4;\n            fill: none;\n            marker-end: url(#arrowhead); /* Add arrowhead */\n            opacity: 0; /* Hidden by default */\n        }\n\n        .heat-particle {\n            fill: #ff6f00; /* Orange glowing particles */\n            stroke: #fff;\n            stroke-width: 0.5;\n            transition: opacity 0.3s ease;\n            opacity: 0; /* Hidden by default */\n        }\n\n        /* Responsive adjustments for smaller screens, though max-width handles most */\n        @media (max-width: 400px) {\n            h1 { font-size: 20px; }\n            .subtitle { font-size: 12px; }\n            #app { padding: 8px; }\n            #visual-area { min-height: 250px; }\n            .control-label { font-size: 14px; }\n            button { font-size: 15px; padding: 10px; }\n            #info { font-size: 14px; }\n        }\n    </style>\n</head>\n<body>\n    <div id=\"app\">\n        <header>\n            <h1>Flow of Heat Simulation</h1>\n            <p class=\"subtitle\">Set temperatures for two objects, then watch heat flow!</p>\n        </header>\n        \n        <div id=\"visual-area\">\n            <svg id=\"simulation_svg\" viewBox=\"0 0 400 200\" preserveAspectRatio=\"xMidYMid meet\">\n                <defs>\n                    <marker id=\"arrowhead\" markerWidth=\"10\" markerHeight=\"7\" refX=\"0\" refY=\"3.5\" orient=\"auto\">\n                        <polygon points=\"0 0, 10 3.5, 0 7\" fill=\"#ff9800\" />\n                    </marker>\n                </defs>\n\n                <!-- Object A -->\n                <rect id=\"objectA_rect\" class=\"object-container\" x=\"50\" y=\"50\" width=\"100\" height=\"100\" fill=\"#FF0000\" rx=\"10\" ry=\"10\" />\n                <text x=\"100\" y=\"40\" text-anchor=\"middle\" font-size=\"16\" class=\"object-label\">Object A</text>\n                <text id=\"tempA_display_svg\" x=\"100\" y=\"120\" text-anchor=\"middle\" font-size=\"20\" class=\"temperature-label\">70</text>\n\n                <!-- Connection Tube -->\n                <rect id=\"connection_rect\" x=\"150\" y=\"70\" width=\"100\" height=\"60\" fill=\"rgba(0,0,0,0.1)\" rx=\"5\" ry=\"5\" stroke=\"#ccc\" stroke-width=\"1\" />\n                \n                <!-- Object B -->\n                <rect id=\"objectB_rect\" class=\"object-container\" x=\"250\" y=\"50\" width=\"100\" height=\"100\" fill=\"#0000FF\" rx=\"10\" ry=\"10\" />\n                <text x=\"300\" y=\"40\" text-anchor=\"middle\" font-size=\"16\" class=\"object-label\">Object B</text>\n                <text id=\"tempB_display_svg\" x=\"300\" y=\"120\" text-anchor=\"middle\" font-size=\"20\" class=\"temperature-label\">30</text>\n                \n                <!-- Directional Arrow -->\n                <path id=\"flow_arrow\" d=\"M160 100 L240 100\" visibility=\"hidden\"/> \n                <!-- Heat Particles Container -->\n                <g id=\"heat_particles_container\" transform=\"translate(150, 100)\">\n                    <!-- Particles will be dynamically generated or moved here -->\n                </g>\n            </svg>\n        </div>\n        \n        <div id=\"controls\">\n            <div class=\"control-group\">\n                <label for=\"sliderA\" class=\"control-label\">\n                    Object A Initial Temperature:\n                    <span id=\"valueA_display\">70 arbitrary units</span>\n                </label>\n                <input type=\"range\" id=\"sliderA\" min=\"0\" max=\"100\" value=\"70\">\n            </div>\n\n            <div class=\"control-group\">\n                <label for=\"sliderB\" class=\"control-label\">\n                    Object B Initial Temperature:\n                    <span id=\"valueB_display\">30 arbitrary units</span>\n                </label>\n                <input type=\"range\" id=\"sliderB\" min=\"0\" max=\"100\" value=\"30\">\n            </div>\n\n            <button id=\"start_flow_button\">Start Heat Flow</button>\n        </div>\n        \n        <div id=\"info\">\n            <p>Current Temperature A: <span id=\"info_tempA\">70</span> arbitrary units</p>\n            <p>Current Temperature B: <span id=\"info_tempB\">30</span> arbitrary units</p>\n            <div id=\"status_message\" class=\"status-message\" style=\"display: none;\"></div>\n        </div>\n    </div>\n    \n    <script>\n        const sliderA = document.getElementById('sliderA');\n        const sliderB = document.getElementById('sliderB');\n        const valueA_display = document.getElementById('valueA_display');\n        const valueB_display = document.getElementById('valueB_display');\n        const startFlowButton = document.getElementById('start_flow_button');\n\n        const objectA_rect = document.getElementById('objectA_rect');\n        const objectB_rect = document.getElementById('objectB_rect');\n        const tempA_display_svg = document.getElementById('tempA_display_svg');\n        const tempB_display_svg = document.getElementById('tempB_display_svg');\n        const flowArrow = document.getElementById('flow_arrow');\n        const heatParticlesContainer = document.getElementById('heat_particles_container');\n\n        const info_tempA = document.getElementById('info_tempA');\n        const info_tempB = document.getElementById('info_tempB');\n        const statusMessage = document.getElementById('status_message');\n\n        const TEMP_MIN = 0;\n        const TEMP_MAX = 100;\n        const HEAT_TRANSFER_FACTOR = 0.05; // How fast temperatures equalize per animation frame\n        const EQUILIBRIUM_THRESHOLD = 0.1; // When temps are considered equal\n\n        let currentTempA = parseInt(sliderA.value);\n        let currentTempB = parseInt(sliderB.value);\n        let animationFrameId = null;\n        let isFlowing = false;\n\n        // Color gradient from deep blue (0) to bright red (100) using HSL for smoother transitions\n        function getColorForTemperature(temp) {\n            const hue = 240 - (temp / TEMP_MAX) * 240; // 240 (blue) -> 0 (red)\n            // Adjust saturation/lightness to make colors more vibrant and distinguishable\n            const saturation = 100; // Full saturation\n            const lightness = 35 + (temp / TEMP_MAX) * 30; // 35% to 65% lightness for visibility\n            return `hsl(${hue}, ${saturation}%, ${lightness}%)`;\n        }\n\n        // Initialize display and colors\n        function initializeSimulation() {\n            currentTempA = parseInt(sliderA.value);\n            currentTempB = parseInt(sliderB.value);\n            updateObjectVisuals(objectA_rect, tempA_display_svg, currentTempA, valueA_display, info_tempA);\n            updateObjectVisuals(objectB_rect, tempB_display_svg, currentTempB, valueB_display, info_tempB);\n            statusMessage.style.display = 'none';\n            statusMessage.textContent = '';\n            flowArrow.style.opacity = '0'; // Use opacity for smooth hide/show\n            flowArrow.setAttribute('visibility', 'hidden');\n            clearHeatParticles();\n            enableControls();\n        }\n\n        function updateObjectVisuals(rectElement, svgTextElement, temp, sliderValueDisplay, infoTextElement) {\n            const color = getColorForTemperature(temp);\n            rectElement.setAttribute('fill', color);\n            svgTextElement.textContent = Math.round(temp);\n            sliderValueDisplay.textContent = `${Math.round(temp)} arbitrary units`;\n            infoTextElement.textContent = Math.round(temp);\n        }\n\n        function clearHeatParticles() {\n            while (heatParticlesContainer.firstChild) {\n                heatParticlesContainer.removeChild(heatParticlesContainer.firstChild);\n            }\n            particles = []; // Clear array reference\n        }\n\n        // Particle generation and movement\n        const PARTICLE_COUNT = 15;\n        const PARTICLE_SIZE = 4;\n        const PARTICLE_SPEED = 2; // Pixels per frame\n        const PARTICLE_TRAVEL_DISTANCE = 100; // SVG units, width of connection rect\n        const TUBE_HEIGHT = 60; // Height of the connection tube\n\n        let particles = [];\n        function createHeatParticles() {\n            clearHeatParticles();\n            for (let i = 0; i < PARTICLE_COUNT; i++) {\n                const particle = document.createElementNS('http://www.w3.org/2000/svg', 'circle');\n                particle.setAttribute('r', PARTICLE_SIZE);\n                particle.setAttribute('fill', '#ff6f00'); // Orange\n                particle.setAttribute('stroke', '#fff');\n                particle.setAttribute('stroke-width', '0.5');\n                particle.setAttribute('class', 'heat-particle');\n                \n                // Position particles initially randomly within the tube area, relative to heatParticlesContainer's transform (150, 100)\n                particle.dataset.currentX = Math.random() * PARTICLE_TRAVEL_DISTANCE;\n                particle.dataset.currentY = (Math.random() - 0.5) * (TUBE_HEIGHT - PARTICLE_SIZE * 2); // Random Y within tube height\n                particle.dataset.speed = PARTICLE_SPEED * (0.8 + Math.random() * 0.4); // Randomize speed slightly\n                particle.style.transform = `translate(${particle.dataset.currentX}px, ${particle.dataset.currentY}px)`;\n                heatParticlesContainer.appendChild(particle);\n                particles.push(particle);\n            }\n        }\n\n        function animateParticles(fromLeft) {\n            particles.forEach(particle => {\n                let currentX = parseFloat(particle.dataset.currentX);\n                let currentY = parseFloat(particle.dataset.currentY);\n                \n                if (fromLeft) {\n                    currentX += parseFloat(particle.dataset.speed);\n                    if (currentX > PARTICLE_TRAVEL_DISTANCE) {\n                        currentX = 0; // Loop back to start of tube\n                        currentY = (Math.random() - 0.5) * (TUBE_HEIGHT - PARTICLE_SIZE * 2); // Reset Y for new loop\n                    }\n                } else { // Right to Left\n                    currentX -= parseFloat(particle.dataset.speed);\n                    if (currentX < 0) {\n                        currentX = PARTICLE_TRAVEL_DISTANCE; // Loop back to end of tube\n                        currentY = (Math.random() - 0.5) * (TUBE_HEIGHT - PARTICLE_SIZE * 2); // Reset Y for new loop\n                    }\n                }\n                particle.dataset.currentX = currentX; // Update currentX for next frame\n                particle.dataset.currentY = currentY; // Update currentY for next frame\n                particle.style.transform = `translate(${currentX}px, ${currentY}px)`;\n                particle.style.opacity = '1';\n            });\n        }\n\n        function hideParticles() {\n            particles.forEach(particle => {\n                particle.style.opacity = '0';\n                // Optionally reset positions or let them fade out\n            });\n        }\n\n        function disableControls() {\n            sliderA.disabled = true;\n            sliderB.disabled = true;\n            startFlowButton.disabled = true;\n        }\n\n        function enableControls() {\n            sliderA.disabled = false;\n            sliderB.disabled = false;\n            startFlowButton.disabled = false;\n        }\n\n        let initialTempA, initialTempB; // Store initial temps for consistent particle direction\n\n        // Animation loop for heat flow\n        function heatFlowAnimation() {\n            if (!isFlowing) {\n                cancelAnimationFrame(animationFrameId);\n                return;\n            }\n\n            const equilibriumTemp = (initialTempA + initialTempB) / 2; // Equilibrium is based on initial average\n            let tempDifference = Math.abs(currentTempA - currentTempB);\n\n            if (tempDifference < EQUILIBRIUM_THRESHOLD) {\n                // Reached equilibrium\n                currentTempA = equilibriumTemp;\n                currentTempB = equilibriumTemp;\n                updateObjectVisuals(objectA_rect, tempA_display_svg, currentTempA, valueA_display, info_tempA);\n                updateObjectVisuals(objectB_rect, tempB_display_svg, currentTempB, valueB_display, info_tempB);\n                statusMessage.textContent = 'Thermal Equilibrium Reached!';\n                statusMessage.style.display = 'block';\n                flowArrow.style.opacity = '0';\n                flowArrow.setAttribute('visibility', 'hidden');\n                hideParticles();\n                isFlowing = false;\n                cancelAnimationFrame(animationFrameId);\n                enableControls();\n                return;\n            }\n\n            let deltaA = (equilibriumTemp - currentTempA) * HEAT_TRANSFER_FACTOR;\n            let deltaB = (equilibriumTemp - currentTempB) * HEAT_TRANSFER_FACTOR; // Should be same magnitude as deltaA if objects are identical\n\n            currentTempA += deltaA;\n            currentTempB += deltaB;\n\n            // Ensure temps don't overshoot or go beyond min/max\n            currentTempA = Math.max(TEMP_MIN, Math.min(TEMP_MAX, currentTempA));\n            currentTempB = Math.max(TEMP_MIN, Math.min(TEMP_MAX, currentTempB));\n\n            updateObjectVisuals(objectA_rect, tempA_display_svg, currentTempA, valueA_display, info_tempA);\n            updateObjectVisuals(objectB_rect, tempB_display_svg, currentTempB, valueB_display, info_tempB);\n\n            // Determine flow direction for particles and arrow based on initial temps\n            const fromLeft = initialTempA > initialTempB;\n            \n            // Update arrow direction\n            if (fromLeft) {\n                flowArrow.setAttribute('d', 'M160 100 L240 100'); // Left to Right\n                flowArrow.setAttribute('marker-end', 'url(#arrowhead)');\n            } else {\n                flowArrow.setAttribute('d', 'M240 100 L160 100'); // Right to Left\n                flowArrow.setAttribute('marker-end', 'url(#arrowhead)');\n            }\n            flowArrow.setAttribute('visibility', 'visible');\n            flowArrow.style.opacity = '1';\n\n            animateParticles(fromLeft);\n\n            animationFrameId = requestAnimationFrame(heatFlowAnimation);\n        }\n\n        // Event Listeners\n        sliderA.addEventListener('input', (e) => {\n            currentTempA = parseInt(e.target.value);\n            updateObjectVisuals(objectA_rect, tempA_display_svg, currentTempA, valueA_display, info_tempA);\n            statusMessage.style.display = 'none'; // Clear status if temps change before flow\n            if (isFlowing) { // If flow is active, stop it to allow new configuration\n                isFlowing = false;\n                cancelAnimationFrame(animationFrameId);\n                hideParticles();\n                flowArrow.style.opacity = '0';\n                flowArrow.setAttribute('visibility', 'hidden');\n                enableControls();\n            }\n        });\n\n        sliderB.addEventListener('input', (e) => {\n            currentTempB = parseInt(e.target.value);\n            updateObjectVisuals(objectB_rect, tempB_display_svg, currentTempB, valueB_display, info_tempB);\n            statusMessage.style.display = 'none'; // Clear status if temps change before flow\n            if (isFlowing) { // If flow is active, stop it to allow new configuration\n                isFlowing = false;\n                cancelAnimationFrame(animationFrameId);\n                hideParticles();\n                flowArrow.style.opacity = '0';\n                flowArrow.setAttribute('visibility', 'hidden');\n                enableControls();\n            }\n        });\n\n        startFlowButton.addEventListener('click', () => {\n            if (isFlowing) return; // Prevent multiple clicks during flow\n\n            initialTempA = parseInt(sliderA.value); // Capture initial temperatures for direction logic\n            initialTempB = parseInt(sliderB.value);\n\n            // If equilibrium already reached, reset to new slider values for a fresh run\n            if (Math.abs(currentTempA - currentTempB) < EQUILIBRIUM_THRESHOLD) {\n                 // This ensures the current temp is reset to the slider value if it was already at equilibrium \n                currentTempA = initialTempA; \n                currentTempB = initialTempB;\n                updateObjectVisuals(objectA_rect, tempA_display_svg, currentTempA, valueA_display, info_tempA);\n                updateObjectVisuals(objectB_rect, tempB_display_svg, currentTempB, valueB_display, info_tempB);\n            }\n\n            if (initialTempA === initialTempB) {\n                statusMessage.textContent = 'Objects are already at the same temperature. No heat flow.';\n                statusMessage.style.display = 'block';\n                return;\n            }\n\n            disableControls();\n            isFlowing = true;\n            statusMessage.style.display = 'none';\n            createHeatParticles(); // Create particles before starting animation\n            animationFrameId = requestAnimationFrame(heatFlowAnimation);\n        });\n\n        // Initial setup\n        initializeSimulation();\n    </script>\n</body>\n</html>",
  "explanations": [
    "Ensured the viewport meta tag is present for mobile responsiveness.",
    "Added `display: flex`, `justify-content: center`, and `align-items: center` to `#visual-area` to correctly center the SVG content.",
    "Set `min-height` for `#visual-area` to ensure adequate space on smaller viewports.",
    "Increased the `min-height` and `min-width` for the `button` element to ensure a touch target of at least 48px on mobile.",
    "The SVG `viewBox` was adjusted to encompass the elements accurately, and `preserveAspectRatio=\"xMidYMid meet\"` was kept to maintain aspect ratio while fitting within the `#visual-area`.",
    "The `svg` element itself was given `width: 90%` and `max-width: 400px` for responsive scaling within its container.",
    "Ensured all JavaScript variables are declared with `let` or `const` and no `console.log` statements were found.",
    "Refined the `getColorForTemperature` function for smoother HSL transitions.",
    "Improved particle animation by using `dataset` for storing particle state and randomizing particle speed slightly.",
    "Added logic to handle cases where initial temperatures are already equal, preventing unnecessary flow initiation."
  ]
}